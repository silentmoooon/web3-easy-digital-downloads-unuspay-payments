!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";!function(){jQuery((function(e){e(document).ajaxError((function(){"function"==typeof window._depayUnmountLoading&&window._depayUnmountLoading()})),e(document).ajaxComplete((function(){"function"==typeof window._depayUnmountLoading&&window._depayUnmountLoading()})),e("form.edd-blocks-form__purchase").on("submit",(async()=>{var t=e("form.edd-blocks-form__purchase").serialize();if(console.log("values",t),t.match("edd-gateway=edd_unuspay_gateway")){let{unmount:e}=await DePayWidgets.Loading({text:"Loading payment data..."});setTimeout(e,1e4)}}))}));const e=async()=>{if(window.location.hash.startsWith("#edd-unuspay-checkout-")){const e=window.location.hash.match(/edd-unuspay-checkout-(.*?)@/)[1],t=JSON.parse(await wp.apiRequest({path:`/unuspay/edd/checkouts/${e}`,method:"POST"}));if(t.redirect)return void(window.location=t.redirect);const n=[];t.tokens.forEach((e=>{n.push({blockchain:e.blockchain,amount:e.amount,token:e.tokenAddress,receiver:e.receiveAddress,fee:{amount:e.feeRate+"%",receiver:e.feeAddress}})}));let o={accept:n,closed:()=>{window.location.hash="",window.location.reload(!0)},track:{method:t=>new Promise(((n,o)=>{try{t.id=e,wp.apiRequest({path:`/unuspay/edd/checkouts/${e}/track`,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(t),dataType:"json"}).done((()=>n({status:200}))).fail(((e,t)=>o(t)))}catch(e){o()}})),poll:{method:()=>new Promise(((t,n)=>{wp.apiRequest({path:"/unuspay/edd/release",method:"POST",data:{checkout_id:e}}).done((e=>{t(e)})).fail(t)}))}}};DePayWidgets.Payment(o)}};document.addEventListener("DOMContentLoaded",e),window.addEventListener("hashchange",e)}()}));
